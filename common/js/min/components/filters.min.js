if(jQuery.fn.extend({autocompleteSearch:function(a){var b=this.closest("form"),c=this;this.autocomplete({serviceUrl:b.data("autocompleteurl"),params:{queryString:c.val(),parent:b.data("parent")},noCache:!0,formatResult:function(a,b){var c="("+$.Autocomplete.utils.escapeRegExChars(b)+")";return a.value.replace(new RegExp(c,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")},dataType:"json",onSelect:function(d){a.submitOnSelect&&(c.val(d.value),b.find(".trigger").val("Autocomplete"),b.submit())},minChars:3})}}),void 0===Filters)var Filters={};Filters.Vars={state:null,title:null,baseUrl:null,replace:!1},Filters.DOM={$form:null,$selects:null,$page:null,$listing:null,$pagination:null,$reset:null,$filter:null,$keyword:null},Filters.init=function(){if(Filters.DOM.$form=$("#filters-form"),Filters.DOM.$form.length&&(Filters.Vars.state={},Filters.DOM.$selects=Filters.DOM.$form.find("select"),Filters.DOM.$page=Filters.DOM.$form.find('input[name="page"]'),Filters.DOM.$listing=$(".listing-results"),Filters.DOM.$pagination=$(".pagination-container"),Filters.DOM.$reset=$(".reset-button"),Filters.DOM.$reset.on("click",Filters.Events.ResetClick),Filters.DOM.$keyword=Filters.DOM.$form.find('input[name="keyword"]'),Filters.DOM.$keyword.autocompleteSearch({submitOnSelect:!0}),Filters.DOM.$form.on("submit",Filters.Events.FilterClick),Filters.DOM.$filter=$(".filter-button"),Filters.DOM.$filter.on("click",Filters.Events.FilterClick),Filters.DOM.$selects.on("change",Filters.Events.SelectChange),Filters.Vars.baseUrl=window.location.protocol+"//"+window.location.host+window.location.pathname,Filters.Vars.title=document.title,Filters.DOM.$listing.on("click",".pagination a",Filters.Events.PaginationClick),Filters.Helpers.SetState(),void 0!==window.history)){var a=Filters.Helpers.Serialize(Filters.Vars.state),b=""!==a?Filters.Vars.baseUrl+"?"+a:Filters.Vars.baseUrl;history.replaceState(Filters.Vars.state,Filters.Vars.title,b),window.onpopstate=Filters.Events.OnPop}},Filters.Events={SelectChange:function(){Filters.DOM.$page.val("1"),Filters.Helpers.SetState(),Filters.Helpers.FetchPage()},FilterClick:function(a){a.preventDefault(),Filters.DOM.$page.val("1"),Filters.Helpers.SetState(),Filters.Helpers.FetchPage()},PaginationClick:function(a){a.preventDefault(),Filters.DOM.$page.val($(this).attr("data-page-num")),Filters.Helpers.SetState(),Filters.Helpers.FetchPage()},ResetClick:function(a){a.preventDefault(),Filters.Helpers.ResetState(),Filters.Helpers.FetchPage()},OnPop:function(a){Filters.Vars.replace=!0,Filters.Helpers.ReplaceState(a.state),Filters.Helpers.FetchPage()}},Filters.Helpers={Serialize:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&(""===encodeURIComponent(a[c])||"page"===c&&"1"===a[c]||b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c])));return b.join("&")},ReplaceState:function(a){null!==a?Filters.Vars.state=a:a={},Filters.Helpers.UpdateFilters(a),Filters.Helpers.SetState()},ResetState:function(){Filters.DOM.$selects.val(""),Filters.DOM.$page.val("1"),Filters.DOM.$keyword.val(""),Filters.Helpers.SetState()},SetState:function(){Filters.DOM.$selects.each(function(a){var b=$(this);Filters.Vars.state[b.attr("name")]=b.val()}),Filters.Vars.state.page=Filters.DOM.$page.val(),null!==Filters.DOM.$keyword&&Filters.DOM.$keyword.length>0&&(Filters.Vars.state.keyword=Filters.DOM.$keyword.val())},FetchPage:function(){Filters.DOM.$listing.addClass("loading"),Filters.DOM.$pagination.addClass("loading"),$.ajax({data:Filters.Vars.state,dataType:"html",url:Filters.Vars.baseUrl}).done(Filters.Helpers.UpdatePage)},ScrollToResults:function(){var a=Filters.DOM.$listing.offset().top,b=$(document).scrollTop(),c=170,d=a-c;d<b&&$("html, body").animate({scrollTop:d+"px"},500)},UpdateFilters:function(a){for(var b in a)a.hasOwnProperty(b)&&("page"!==b?Filters.DOM.$selects.filter('[name="'+b+'"]').val(a[b]):""!==a[b]?Filters.DOM.$page.val(a[b]):Filters.DOM.$page.val("1"))},UpdatePage:function(a){Filters.DOM.$listing.removeClass("loading"),Filters.DOM.$pagination.removeClass("loading");var b=$(a),c=b.find(".listing-results"),d=b.find(".pagination-container");Filters.Vars.title=b.filter("title"),Filters.DOM.$page.val(Filters.Vars.state.page),Filters.DOM.$listing.html(c.html()),d.length&&Filters.DOM.$pagination.html(d.html()),Filters.Helpers.UpdateHistory(),Filters.Helpers.ScrollToResults()},UpdateHistory:function(){if("undefined"!=typeof history){var a=Filters.Helpers.Serialize(Filters.Vars.state),b=""!==a?Filters.Vars.baseUrl+"?"+a:Filters.Vars.baseUrl;Filters.Vars.replace?(history.replaceState(Filters.Vars.state,Filters.Vars.title,b),Filters.Vars.replace=!1):history.pushState(Filters.Vars.state,Filters.Vars.title,b)}}},Filters.init();